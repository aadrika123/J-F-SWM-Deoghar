import{j as e,g as k,_ as u,u as G}from"./index-D9SUnkI2.js";import{R as V,r as y,f as J}from"./router-DQohkvhc.js";import{P as K}from"./index-BhPwl-Wc.js";import{I as Q}from"./Image-C1TMCRx8.js";import{S as U}from"./separator-ZtTJhbg_.js";import{u as O,b as X}from"./useCustomQuery-DgvKAbQU.js";import{B as C}from"./button-IjAY8dzr.js";import{c as $,b as d,a as E,F as W,o as H,S as w}from"./SelectField-WJfBqNjK.js";import{g as Y}from"./services-KQnp_8oA.js";import{R as Z}from"./RHFTextArea-Cmq2qkMm.js";import{B as D}from"./ButtonLoading-B7KNBhZv.js";import{C as ee}from"./card-BocCdTs6.js";import{C as _}from"./index-DIInLEzD.js";import{a as ae,b as se}from"./useComonData-BiZaX7UW.js";import{u as te}from"./useMonthMap-C8hLMgQU.js";import{R as v}from"./RHFTextField-BdHjFRnA.js";import{O as re}from"./OverLayLoader-B_NdIHLb.js";import"./headlessui-qWRqSxHB.js";import"./axios-DmypytPv.js";import"./moment-BjLXg0w5.js";import"./module-CLOPZauA.js";function de({open:t,consumer:a,setOpen:h,title:p,refetch:m}){const n=O({}),b=$().shape({remarks:d().required("Remarks is required")}),c=E({resolver:H(b),defaultValues:{remarks:""}}),f=async x=>{_("Are you sure to pay?","Please confirm",async()=>{var g,o,j;try{const r=await n.mutateAsync({api:k.postDeactivateConsumer,data:{...x,consumerId:a==null?void 0:a.consumerId}});(g=r==null?void 0:r.data)!=null&&g.status?(u.success((o=r==null?void 0:r.data)==null?void 0:o.msg),h(!1),m&&m()):u.error((j=r==null?void 0:r.data)==null?void 0:j.msg)}catch(r){u.error(Y(r))}})},s=()=>h(!t);return e.jsxs(V.Fragment,{children:[t&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:`${t?"flex":"hidden"} overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full`,children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:p??"Deactivate Consumer"}),e.jsxs("button",{style:{background:"none"},onClick:s,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsxs("div",{className:"p-4 md:p-5",children:[e.jsx(ee,{className:"bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 p-4",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold",children:"Consumer no:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:a==null?void 0:a.consumerNo})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold",children:"Consumer name:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:a==null?void 0:a.consumerName})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold",children:"Ward:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:a==null?void 0:a.wardNo})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold",children:"Total demand:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:a==null?void 0:a.totaldemand})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold",children:"Address:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:a==null?void 0:a.address})})]})}),e.jsx("div",{className:"mt-8"}),e.jsxs(W,{methods:c,onSubmit:c.handleSubmit(f),children:[e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsx("div",{children:e.jsx(Z,{name:"remarks",label:"Remarks",placeholder:"Remarks"})})}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(D,{isLoading:n==null?void 0:n.isPending,disabled:n==null?void 0:n.isPending,type:"submit",variant:"destructive",size:"sm",className:"rounded-md w-24",children:"Deactivate"})})]})]})]})})})]})}function ie({open:t,consumerDetails:a,setOpen:h,title:p,mutate:m,refetch:n}){var j,r,S,A,F,I,L,M;const{resultList:b}=te("4-1-2022"),{getConsumerAddFormData:c}=ae(),f=$().shape({wardNo:d().required().label("Ward no"),apartmentId:d().required().label("Choose Apartment"),consumerName:d().required().label("Consumer name"),mobileNo:d().required().label("Mobile no"),consumerCategory:d().required().label("Consumer category"),consumerType:d().required().label("Consumer type"),demandFrom:d().required().label("Demand from"),firmName:d().when("consumerCategory",{is:"2",then:()=>d().required().label("Firm name")}),licenseNo:d().when("consumerCategory",{is:"2",then:()=>d().required().label("License no")}),address:d(),pinCode:d()}),s=E({resolver:H(f),defaultValues:{address:"",pinCode:"",wardNo:"",apartmentId:"",consumerName:"",mobileNo:"",consumerCategory:"",consumerType:"",demandFrom:"",firmName:"",licenseNo:""}}),{consumerCategoryData:x}=se(String(s.watch("consumerCategory")));y.useEffect(()=>{var i,N,l,q,T,P,R,z,B;(i=a==null?void 0:a.data)!=null&&i.data&&(s.setValue("wardNo",String((l=(N=a==null?void 0:a.data)==null?void 0:N.data[0])==null?void 0:l.wardNo)),s.setValue("apartmentId",String((T=(q=a==null?void 0:a.data)==null?void 0:q.data[0])==null?void 0:T.id)),s.setValue("address",(R=(P=a==null?void 0:a.data)==null?void 0:P.data[0])==null?void 0:R.address),s.setValue("pinCode",(B=(z=a==null?void 0:a.data)==null?void 0:z.data[0])==null?void 0:B.pinCode))},[a]);const g=async i=>{h(!1),_("Are you sure to pay?","Please confirm",async()=>{var N;try{const l=await(m==null?void 0:m.mutateAsync({api:(N=k)==null?void 0:N.postConsumerAdd,data:i}));l!=null&&l.data.status?(u.success(l==null?void 0:l.data.msg),n()):u.error(l==null?void 0:l.data.msg)}catch{u.error("Something went wrong")}})},o=()=>h(!t);return e.jsxs(V.Fragment,{children:[t&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsxs("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:`${t?"flex":"hidden"} overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full`,children:[s.watch("apartmentId"),e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:[p??"Add Floor"," ",(r=(j=a==null?void 0:a.data)==null?void 0:j.data[0])==null?void 0:r.wardNo]}),e.jsxs("button",{style:{background:"none"},onClick:o,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsx("div",{className:"p-4 md:p-5",children:e.jsxs(W,{methods:s,onSubmit:s.handleSubmit(g),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{children:e.jsx(w,{name:"consumerCategory",label:"Consumer Category",data:((F=(A=(S=c==null?void 0:c.data)==null?void 0:S.data)==null?void 0:A.consumerCategory)==null?void 0:F.map(i=>({label:String(i.name),value:String(i.id)})))??[]})}),e.jsx("div",{children:e.jsx(w,{name:"consumerType",label:"Consumer Type",data:((M=(L=(I=x==null?void 0:x.data)==null?void 0:I.data)==null?void 0:L.consumerTypeList)==null?void 0:M.map(i=>({label:String(i.name),value:String(i.id)})))??[]})}),{2:e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(v,{name:"firmName",label:"Firm Name",type:"text"})}),e.jsx("div",{children:e.jsx(v,{name:"licenseNo",label:"License No",type:"text"})})]})}[s.watch("consumerCategory")],e.jsx("div",{children:e.jsx(v,{name:"consumerName",label:"Consumer Name",type:"text",inputValidation:["removeDoubleSpace"]})}),e.jsx("div",{children:e.jsx(v,{name:"mobileNo",label:"Mobile No",inputValidation:["mobile","number"]})}),e.jsx("div",{children:e.jsx(w,{name:"demandFrom",label:"Demand From",data:b.map(i=>({label:String(i.str),value:String(i.str)}))??[]})})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(C,{type:"submit",variant:"default",size:"sm",className:"rounded-md w-24",children:"Add"})})]})})]})})]})]})}function Fe(){var x,g;const{user:t}=G(),a=O({}),[h,p]=y.useState(!1),[m,n]=y.useState(!1),[b,c]=y.useState(null),{id:f}=J(),s=X({api:`${k.getApartmentDetailsById}/${f}`,options:{enabled:!!f}});return e.jsxs(K,{title:"All flats",children:[e.jsx(ie,{open:h,setOpen:p,consumerDetails:s,mutate:a,refetch:s.refetch}),m&&e.jsx(de,{open:m,setOpen:n,consumer:b,refetch:s.refetch}),a.isPending&&e.jsx(re,{}),e.jsxs("main",{className:"py-6 grid grid-cols-1 gap-4 px-4",children:[e.jsxs("div",{className:"flex space-x-3 items-center justify-start",children:[e.jsx(Q,{src:"/assets/image/category.png",alt:"All flats",className:"w-11 h-11 rounded-lg bg-gray-200 p-2"}),e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"font-semibold",children:"All flats"}),e.jsx("p",{className:"text-xs text-gray-500",children:"All flats details here."})]})]}),(t==null?void 0:t.userTypeId)==4&&e.jsx("div",{className:"flex space-x-3 items-center justify-end",children:e.jsx(C,{size:"sm",onClick:()=>{p(!0)},children:"Add Flats"})}),e.jsx(U,{}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:(g=(x=s.data)==null?void 0:x.data)==null?void 0:g.map((o,j)=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 flex gap-4  justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Consumer name"}),e.jsx("h2",{className:"font-semibold text-sm",children:o.consumerName})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Consumer no"}),e.jsx("h2",{className:"font-semibold text-sm",children:o.consumerNo})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Mobile no"}),e.jsx("h2",{className:"font-semibold text-sm",children:o.mobileNo})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Monthly rate"}),e.jsx("h2",{className:"font-semibold text-sm",children:o.monthlyDemand})]})]}),(t==null?void 0:t.userTypeId)==4&&e.jsx("div",{className:"mb-0",children:e.jsx(C,{size:"sm",onClick:()=>{c(o),n(!0)},className:"bg-red-700 text-white",children:"Deactivate"})})]},j+1))})]})]})}export{Fe as default};
