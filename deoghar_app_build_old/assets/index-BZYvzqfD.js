import{u as re,h as y,e as h,j as e,I as se,B as te,C as de,_ as C}from"./index-DskiXWfo.js";import{P as ne}from"./index-CRX5ZJ8K.js";import{C as oe,b as ie}from"./card-Bj2cLFo1.js";import{c as me,a as t,u as le,F as ue,o as ce}from"./switch-LxJsj5Bc.js";import{R as b}from"./RHFTextField-DW3dHTKl.js";import{R as pe}from"./RHFTextArea-u7tjeRKC.js";import{u as xe,r as w}from"./router-DWxcwEcu.js";import{R as p}from"./SelectField-H8INzAoa.js";import{a as he,u as be,b as ge}from"./useComonData-EKCwqAFE.js";import{S as je}from"./separator-BTd2xj_o.js";import{u as Ne}from"./useMonthMap-DqC9yJdg.js";import{O as fe}from"./OverLayLoader-D59R5ziZ.js";import"./headlessui-DlCzxctq.js";import"./axios-BrYcoDUu.js";import"./moment-CbGOrKEH.js";import"./module-CwN8NruV.js";function Ie(){var q,S,R,F,$,A,L,T,P,M,V,E,H,I,W,_,O,z,U,k,J,K,Q;const B=xe(),x=re({}),G=window.location.search,i=new URLSearchParams(G).get("id"),{resultList:D}=Ne("4-1-2022"),{getConsumerAddFormData:g}=he(),{getAllUser:j}=be(),ee=me().shape({wardNo:t().required().label("Ward no"),apartmentId:t().required().label("Choose Apartment"),consumerName:t().required().label("Consumer name"),mobileNo:t().required().label("Mobile no"),consumerCategory:t().required().label("Consumer category"),consumerType:t().required().label("Consumer type"),demandFrom:t().required().label("Demand from"),firmName:t().when("consumerCategory",{is:"2",then:()=>t().required().label("Firm name")}),licenseNo:t().when("consumerCategory",{is:"2",then:()=>t().required().label("License no")}),address:t().notRequired().label("Address"),pinCode:t().notRequired().label("Pin code")}),d=le({resolver:ce(ee),defaultValues:{wardNo:"",apartmentId:"",address:"",pinCode:"",consumerName:"",mobileNo:"",consumerCategory:"",consumerType:"",demandFrom:"",firmName:"",licenseNo:""}}),r=y({api:"".concat(h.getApartmentDetailsById,"/").concat(i),options:{enabled:!!i}}),v=w.useMemo(()=>{var a,o,s,m,l,u,c,X,Y,Z;return{wardNo:"".concat((o=(a=r==null?void 0:r.data)==null?void 0:a.data[0])==null?void 0:o.wardNo)||"",apartmentId:"".concat((m=(s=r==null?void 0:r.data)==null?void 0:s.data[0])==null?void 0:m.id)||"",address:(c=(u=(l=r==null?void 0:r.data)==null?void 0:l.data[0])==null?void 0:u.address)!=null?c:"",pinCode:(Z=(Y=(X=r==null?void 0:r.data)==null?void 0:X.data[0])==null?void 0:Y.pinCode)!=null?Z:"",consumerName:"",mobileNo:"",consumerCategory:"",consumerType:"",demandFrom:"",firmName:"",licenseNo:""}},[(S=(q=r==null?void 0:r.data)==null?void 0:q.data[0])==null?void 0:S.id,(F=(R=r==null?void 0:r.data)==null?void 0:R.data[0])==null?void 0:F.wardNo]);w.useEffect(()=>{i&&d.reset(v)},[i,v]);const{consumerCategoryData:N}=ge(String(d.watch("consumerCategory"))),f=y({api:"".concat(h.getApartmentListByWardNo,"/").concat(d.watch("wardNo")),options:{enabled:!!d.watch("wardNo")}}),n=y({api:"".concat(h.getApartmentDetailsById,"/").concat(d.watch("apartmentId")),options:{enabled:!!d.watch("apartmentId")}});w.useEffect(()=>{var a,o,s,m,l,u,c;(o=(a=n==null?void 0:n.data)==null?void 0:a.data)!=null&&o[0]&&(d.setValue("address","".concat((l=(m=(s=n==null?void 0:n.data)==null?void 0:s.data)==null?void 0:m[0])==null?void 0:l.address)),d.setValue("pinCode",(c=(u=n==null?void 0:n.data)==null?void 0:u.data[0])==null?void 0:c.pinCode))},[(A=($=n==null?void 0:n.data)==null?void 0:$.data)==null?void 0:A[0]]);const ae=async a=>{de("Are you sure?","Please confirm",async()=>{var o;try{const s=await(x==null?void 0:x.mutateAsync({api:(o=h)==null?void 0:o.postConsumerAdd,data:a}));s!=null&&s.data.status?(C.success(s==null?void 0:s.data.msg),B("/deoghar-app/apartment-actions/".concat(d.watch("apartmentId")))):C.error(s==null?void 0:s.data.msg)}catch(s){C.error("Something went wrong")}})};return e.jsxs(ne,{title:"Add Flats",children:[x.isLoading&&e.jsx(fe,{}),e.jsxs("main",{className:"py-6 grid grid-cols-1 gap-4 px-4",children:[e.jsxs("div",{className:"flex space-x-3 items-center justify-start",children:[e.jsx(se,{src:"/assets/image/category.png",alt:"Add Flats",className:"w-11 h-11 rounded-lg bg-gray-200 p-2"}),e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"font-semibold",children:"Add flats"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Solid waste management system"})]})]}),e.jsx(je,{}),e.jsx(oe,{children:e.jsx(ie,{children:e.jsxs(ue,{methods:d,onSubmit:d.handleSubmit(ae),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{children:e.jsx(p,{isRequired:!0,disabled:!!i,name:"wardNo",label:"Ward No",data:(M=(P=(T=(L=j==null?void 0:j.data)==null?void 0:L.data[0].ulbDetails[0])==null?void 0:T.wards)==null?void 0:P.map(a=>({label:String(a),value:String(a)})))!=null?M:[]})}),e.jsx("div",{children:e.jsx(p,{isRequired:!0,disabled:!!i,name:"apartmentId",label:"Choose Apartment",data:(I=(H=(E=(V=f==null?void 0:f.data)==null?void 0:V.data)==null?void 0:E.apartmentList)==null?void 0:H.map(a=>({label:String(a.apt_name),value:String(a.id)})))!=null?I:[]})}),e.jsx("div",{children:e.jsx(p,{isRequired:!0,name:"consumerCategory",label:"Consumer Category",data:(z=(O=(_=(W=g==null?void 0:g.data)==null?void 0:W.data)==null?void 0:_.consumerCategory)==null?void 0:O.map(a=>({label:String(a.name),value:String(a.id)})))!=null?z:[]})}),e.jsx("div",{children:e.jsx(p,{isRequired:!0,name:"consumerType",label:"Consumer Type",data:(K=(J=(k=(U=N==null?void 0:N.data)==null?void 0:U.data)==null?void 0:k.consumerTypeList)==null?void 0:J.map(a=>({label:String(a.name),value:String(a.id)})))!=null?K:[]})}),{2:e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(b,{isRequired:!0,name:"firmName",label:"Firm Name",type:"text"})}),e.jsx("div",{children:e.jsx(b,{name:"licenseNo",isRequired:!0,label:"License No",type:"text"})})]})}[d.watch("consumerCategory")],e.jsx("div",{children:e.jsx(b,{name:"consumerName",isRequired:!0,label:"Consumer Name",type:"text",inputValidation:["removeDoubleSpace"]})}),e.jsx("div",{children:e.jsx(b,{type:"number",isRequired:!0,name:"mobileNo",label:"Mobile No",inputValidation:["mobile"]})}),e.jsx("div",{children:e.jsx(pe,{name:"address",isRequired:!0,label:"Address",disabled:!0})}),e.jsx("div",{children:e.jsx(p,{name:"demandFrom",isRequired:!0,label:"Demand From",data:(Q=D.map(a=>({label:String(a.str),value:String(a.str)})))!=null?Q:[]})})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(te,{type:"submit",variant:"default",size:"sm",className:"rounded-md w-24",children:"Add"})})]})})})]})]})}export{Ie as default};
