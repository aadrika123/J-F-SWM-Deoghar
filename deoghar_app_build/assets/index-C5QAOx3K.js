import{j as e,C as T,d as q,_ as c}from"./index-CKexVv7f.js";import{P}from"./index-BHeHt4x3.js";import{C as L,b as M}from"./card-0XrvENI5.js";import{c as V,a,u as B,F as D,S as i,o as I}from"./SelectField-CJOU9OFV.js";import{R as n}from"./RHFTextField-D3c84PJ-.js";import{B as R}from"./ButtonLoading-DeNqAQPL.js";import{d as $}from"./router-CTqkcgir.js";import{a as z,u as G,b as H}from"./useComonData-Mkhus79Y.js";import{I as W}from"./Image-CXKymwKi.js";import{S as _}from"./separator-BnIc1-si.js";import{u as E}from"./useMonthMap-C8hLMgQU.js";import{u as k}from"./useCustomQuery-Bm7Wew5S.js";import"./headlessui-BV7w-sRG.js";import"./axios-DmypytPv.js";import"./moment-BjLXg0w5.js";function ie(){var u,p,x,g,h,b,j,y,N;const S=$(),t=k({}),{resultList:w}=E("4-1-2022"),{getConsumerAddFormData:d}=z(),{getAllUser:m}=G(),F=V().shape({wardNo:a().required().label("Ward no"),holdingNo:a(),consumerName:a().required().label("Consumer name"),mobileNo:a().required().label("Mobile no"),address:a().required().label("Address"),pinCode:a().required().label("Pin code"),consumerCategory:a().required().label("Consumer category"),consumerType:a().required().label("Consumer type"),demandFrom:a().required().label("Demand from"),firmName:a().when("consumerCategory",{is:"2",then:()=>a().required().label("Firm name")}),licenseNo:a().when("consumerCategory",{is:"2",then:()=>a().required().label("License no")}),selectText:a()}),o=B({resolver:I(F),defaultValues:{wardNo:"",holdingNo:"",consumerName:"",mobileNo:"",address:"",pinCode:"",consumerCategory:"",consumerType:"",demandFrom:"",firmName:"",licenseNo:"",selectText:""}}),{consumerCategoryData:l}=H(String(o.watch("consumerCategory"))),A=async s=>{T("Are you sure?","Please confirm",async()=>{var C,f,v;try{const r=await(t==null?void 0:t.mutateAsync({api:(C=q)==null?void 0:C.postConsumerAdd,data:s}));r!=null&&r.data.status?(c.success(r==null?void 0:r.data.msg),S(`/deoghar-app/consumer-actions/${(v=(f=r==null?void 0:r.data)==null?void 0:f.data)==null?void 0:v.consumerId}`)):c.error(r==null?void 0:r.data.msg)}catch{c.error("Something went wrong")}})};return e.jsx(P,{title:"Add Consumer",children:e.jsxs("main",{className:"py-6 grid grid-cols-1 gap-4 px-4",children:[e.jsxs("div",{className:"flex space-x-3 items-center justify-start",children:[e.jsx(W,{src:"/assets/image/category.png",alt:"Add Consumer",className:"w-11 h-11 rounded-lg bg-gray-200 p-2"}),e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"font-semibold",children:"Add Consumer"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Add consumer details here."})]})]}),e.jsx(_,{}),e.jsx(L,{children:e.jsx(M,{children:e.jsxs(D,{methods:o,onSubmit:o.handleSubmit(A),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{children:e.jsx(i,{selectedText:"selectText",name:"consumerCategory",label:"Consumer Category",data:((x=(p=(u=d==null?void 0:d.data)==null?void 0:u.data)==null?void 0:p.consumerCategory)==null?void 0:x.map(s=>({label:String(s.name),value:String(s.id)})))??[]})}),e.jsx("div",{children:e.jsx(i,{name:"consumerType",label:"Consumer Type",data:((b=(h=(g=l==null?void 0:l.data)==null?void 0:g.data)==null?void 0:h.consumerTypeList)==null?void 0:b.map(s=>({label:String(s.name),value:String(s.id)})))??[]})}),{2:e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(n,{name:"firmName",label:"Firm Name",type:"text"})}),e.jsx("div",{children:e.jsx(n,{name:"licenseNo",label:"License No",type:"text"})})]})}[o.watch("consumerCategory")],e.jsx("div",{children:e.jsx(i,{name:"wardNo",label:"Ward No",data:((N=(y=(j=m==null?void 0:m.data)==null?void 0:j.data[0].ulbDetails[0])==null?void 0:y.wards)==null?void 0:N.map(s=>({label:String(s),value:String(s)})))??[]})}),e.jsx("div",{children:e.jsx(n,{name:"holdingNo",label:"Holding No",type:"text",inputValidation:["removeSpace"]})}),e.jsx("div",{children:e.jsx(n,{name:"consumerName",label:"Consumer Name",type:"text",inputValidation:["removeDoubleSpace"]})}),e.jsx("div",{children:e.jsx(n,{name:"mobileNo",type:"number",label:"Mobile No",inputValidation:["mobile","number"]})}),e.jsx("div",{children:e.jsx(n,{name:"address",label:"Address",type:"text"})}),e.jsx("div",{children:e.jsx(n,{name:"pinCode",label:"Pin Code",type:"text",inputValidation:["zip"]})}),e.jsx("div",{children:e.jsx(i,{name:"demandFrom",label:"Demand From",data:w.map(s=>({label:String(s.str),value:String(s.str)}))??[]})})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(R,{isLoading:t.isPending,disabled:t.isPending,type:"submit",variant:"default",size:"sm",className:"rounded-md w-24",children:"Add Consumer"})})]})})})]})})}export{ie as default};
