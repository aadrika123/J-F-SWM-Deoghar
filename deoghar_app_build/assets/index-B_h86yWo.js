import{u as v,j as e,g as N,_ as u}from"./index-DEQSo8aR.js";import{r as b,b as K,f as Q}from"./router-DQohkvhc.js";import{P as X}from"./index-DbbiDRHT.js";import{C as f,b as I}from"./card-DMq4rXlK.js";import{I as q}from"./Image-CjBEPl8g.js";import{u as B,b as Z}from"./useCustomQuery-B1dDSXi8.js";import{S as V}from"./separator-_aC8Wpbw.js";import{S as y}from"./SkeletonLoader-DoqmtU4g.js";import{a as W,o as G,F as H,c as U,b as h,S as ee}from"./SelectField-DmQJQBR3.js";import{R as O}from"./RHFTextField-BtHbYK6Z.js";import{R as _}from"./RHFTextArea-DXhfXw5m.js";import{B as j}from"./button-EPqXjhZy.js";import{C as Y}from"./index-aDB13eqf.js";import{u as se}from"./useGeoLocation-Busbjqm0.js";import"./headlessui-qWRqSxHB.js";import"./axios-DmypytPv.js";const te=U().shape({reminderDate:h().required("Apartment Type is required"),reminderTime:h().required("Apartment Category is required"),remarks:h().required("Apartment Status is required")});function ae({open:r,setOpen:l,title:g,aptData:m}){const{user:o}=v(),i=B({}),a=()=>l(!r),s=W({resolver:G(te),defaultValues:{reminderDate:"",reminderTime:"",remarks:""}}),x=async n=>{Y("Are you sure to pay?","Please confirm",async()=>{try{const d=await i.mutateAsync({api:N.postReminder,data:{...n,userId:o==null?void 0:o.id,consumerId:m}});d.data.status?(u.success(d.data.msg),l(!1)):u.error(d.data.msg)}catch(d){u.error(d.msg)}})};return e.jsxs("div",{children:[r&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:`${r?"flex":"hidden"} overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full`,children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:g??"Add Reminder"}),e.jsxs("button",{style:{background:"none"},onClick:a,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsx("div",{className:"p-4 md:p-5",children:e.jsxs(H,{methods:s,onSubmit:s.handleSubmit(x),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(O,{name:"reminderDate",label:"Reminder Date",type:"date"})}),e.jsx("div",{children:e.jsx(O,{name:"reminderTime",label:"Reminder Time",type:"time"})}),e.jsx("div",{className:"col-span-2",children:e.jsx(_,{name:"remarks",label:"Remarks"})})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 mb-2",children:[e.jsx(j,{size:"sm",type:"button",onClick:a,className:"bg-gray-200 text-gray-900 w-20",children:"Cancel"}),e.jsx(j,{size:"sm",type:"submit",className:"w-20",children:"SAVE"})]})]})})]})})})]})}const ie=[{value:"Door Closed",label:"Door Closed"},{value:"No Response from CitizenCitizen Will Pay Next Month",label:"No Response from Citizen"},{value:"Citizen Will Pay Next Day",label:"Citizen Will Pay Next Day"},{value:"Citizen Will Pay Next Month",label:"Citizen Will Pay Next Month"},{value:"Refuses to Pay",label:"Refuses to Pay"},{value:"other",label:"Other"}],ne=U().shape({denyList:h().required("Deny List is required"),latitude:h(),longitude:h(),remarks:h().required("Remarks is required")});function re({open:r,setOpen:l,title:g,aptData:m}){const o=B({}),{user:i}=v(),{coords:a,isGeolocationEnabled:s}=se(),x=()=>l(!r),n=W({resolver:G(ne),defaultValues:{denyList:"",latitude:"",longitude:"",remarks:""}}),d=async p=>{l(!1),Y("Are you sure?","Please confirm",async()=>{try{const c=await o.mutateAsync({api:N.postPaymentDeny,data:{...p,userId:i==null?void 0:i.id,consumerId:m}});c.data.status?(u.success(c.data.msg),l(!1)):u.error(c.data.msg)}catch(c){u.error(c.msg)}})};return b.useEffect(()=>{m&&(n.setValue("latitude",String(a==null?void 0:a.latitude)),n.setValue("longitude",String(a==null?void 0:a.longitude))),n.watch("denyList")!=="other"&&n.setValue("remarks",n.watch("denyList")),n.watch("denyList")==="other"&&n.setValue("remarks","")},[n.watch("denyList")]),e.jsxs("div",{children:[r&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:`${r?"flex":"hidden"} overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full`,children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:g??"Add Deny"}),e.jsxs("button",{style:{background:"none"},onClick:x,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsx("div",{className:"p-4 md:p-5",children:s?e.jsxs(H,{methods:n,onSubmit:n.handleSubmit(d),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(ee,{name:"denyList",label:"Deny List",data:ie})}),n.watch("denyList")==="other"&&e.jsx("div",{className:"col-span-2",children:e.jsx(_,{name:"remarks",label:"Remarks"})})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 mb-2",children:[e.jsx(j,{size:"sm",type:"button",onClick:x,className:"bg-gray-200 text-gray-900 w-20",children:"Cancel"}),e.jsx(j,{size:"sm",type:"submit",className:"w-20",children:"SAVE"})]})]}):e.jsx("div",{className:"text-center py-4",children:e.jsx("h1",{className:"text-sm font-semibold text-red-600",children:"Please enable location to continue"})})})]})})})]})}const de=[{title:"View & Pay",icon:"/icons/grid.svg",size:"w-7",link:"/deoghar-app/consumer-payment",bg:"bg-gradient-to-tl from-[#EEF2FF] to-[#9CC6F7]",accessMenu:["4","5"]},{title:"Transaction History",icon:"/icons/history.svg",size:"w-7",link:"/deoghar-app/tran-history",bg:"bg-gradient-to-tl from-[#FFEFE4] to-[#FFBC96]",accessMenu:["4","5"]},{title:"Geo Map",icon:"/icons/location.svg",size:"w-8",link:"/deoghar-app/con-geo-map",bg:"bg-gradient-to-tl from-[#E4F6FF] to-[#9ADCFF]",accessMenu:["4","5"]},{title:"Reminder",icon:"/icons/bells.svg",size:"w-10",link:"/deoghar-app/details",bg:"bg-gradient-to-tl from-[#FEE8FF] to-[#E4AFFF]",accessMenu:["4","5"]},{title:"Deny List",icon:"/icons/deniel2.svg",size:"w-6",link:"/deoghar-app/details",bg:"bg-gradient-to-tl from-[#FFECEC] to-[#FECACA]",accessMenu:["4","5"]},{title:"Geo Tagging",icon:"/icons/location.svg",size:"w-8",link:"/deoghar-app/con-geo-tagging",bg:"bg-gradient-to-tl from-[#E1FFC3] to-[#C9F98D]",accessMenu:["4"]},{title:"Update Consumer",icon:"/icons/update.svg",size:"w-8",link:"/deoghar-app/update-consumer",bg:"bg-gradient-to-tl from-[#EAD9FF] to-[#C291FF]",accessMenu:["4"]},{title:"Deactivate Consumer",icon:"/icons/deactivate.svg",size:"w-8",link:"/deoghar-app/con-deactivated",bg:"bg-gradient-to-tl from-[#FFECEC] to-[#FECACA]",accessMenu:["4"]},{title:"Payment Adjustment",icon:"/icons/cur.svg",size:"w-8",bg:"bg-gradient-to-tl from-[#FFF5CE] to-[#FCD451]",link:"/deoghar-app/demand-con-adjust",accessMenu:["4"]},{title:"Print Demand",icon:"/icons/denial.svg",bg:"bg-gradient-to-tl from-[#E1FFC3] to-[#C9F98D]",link:"/deoghar-app/print-demand-con",accessMenu:["4"]},{title:"Add Renter",icon:"/icons/add-consumer.svg",bg:"bg-gradient-to-tl from-[#E4F6FF] to-[#9ADCFF]",link:"/deoghar-app/add-renter",accessMenu:["4"]}];function Ce(){var x,n,d,p,c,k,C,w,F,A,$,E,z,L,M,R,P,S,T,D;const{user:r}=v(),[l,g]=b.useState(!1),[m,o]=b.useState(!1),i=K(),{id:a}=Q(),s=Z({api:`${N.getConsumerDetailsById}/${a}`,options:{enabled:!!a}});return s!=null&&s.isLoading?e.jsx("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm",children:e.jsx(f,{children:e.jsxs(I,{children:[e.jsx(y,{}),e.jsx(y,{}),e.jsx(y,{})]})})}):e.jsxs(X,{title:"Consumer Action",children:[l&&e.jsx(ae,{open:l,setOpen:g,aptData:(x=s==null?void 0:s.data)==null?void 0:x.data[0].id}),m&&e.jsx(re,{open:m,setOpen:o,aptData:(n=s==null?void 0:s.data)==null?void 0:n.data[0].id}),e.jsxs("main",{className:"py-6 grid grid-cols-1 gap-4 px-4",children:[e.jsxs("div",{className:"flex space-x-3 items-center justify-start",children:[e.jsx(q,{src:"/assets/image/category.png",alt:"Add Consumer",className:"w-11 h-11 rounded-lg bg-gray-200 p-2"}),e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"font-semibold",children:"Consumer Action"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Consumer action details here."})]})]}),e.jsx(V,{}),e.jsx(f,{children:e.jsx(I,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 py-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-xs font-semibold",children:"Consumer No:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:(p=(d=s==null?void 0:s.data)==null?void 0:d.data[0])==null?void 0:p.consumerNo})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs font-semibold",children:"Consumer Name:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:(k=(c=s==null?void 0:s.data)==null?void 0:c.data[0])==null?void 0:k.consumerName})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs font-semibold",children:"Consumer Mobile:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:(w=(C=s==null?void 0:s.data)==null?void 0:C.data[0])==null?void 0:w.mobileNo})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs font-semibold",children:"Monthly Demand/Rate:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:(A=(F=s==null?void 0:s.data)==null?void 0:F.data[0])==null?void 0:A.monthlyDemand})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs font-semibold",children:"Outstanding Demand:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:(E=($=s==null?void 0:s.data)==null?void 0:$.data[0])==null?void 0:E.totalDemand})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs font-semibold",children:"Demand upto:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:(L=(z=s==null?void 0:s.data)==null?void 0:z.data[0])==null?void 0:L.demandUpto})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs font-semibold",children:"Demand from:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:(R=(M=s==null?void 0:s.data)==null?void 0:M.data[0])==null?void 0:R.demandFrom})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs font-semibold",children:"Consumer type:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:(S=(P=s==null?void 0:s.data)==null?void 0:P.data[0])==null?void 0:S.cansumerType})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs font-semibold",children:"Address:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:(D=(T=s==null?void 0:s.data)==null?void 0:T.data[0])==null?void 0:D.Address})})]})})}),e.jsx(V,{}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:de.map((t,J)=>t.accessMenu.includes(`${r==null?void 0:r.userTypeId}`)&&e.jsxs("div",{className:"flex items-center flex-col cursor-pointer mt-2",children:[e.jsx(f,{onClick:()=>{t.title==="View & Pay"&&i(`${t.link}/${a}`),t.title=="Update Consumer"&&i(`${t.link}/${a}`),t.title=="All Flats List"&&i(`${t.link}/${a}`),t.title=="Transaction History"&&i(`${t.link}?id=${a}&tranType=consumerId`),t.title=="Update Apartment"&&i(`${t.link}/${a}`),t.title=="Payment Adjustment"&&i(`${t.link}/${a}`),t.title=="Deactivate Apartment"&&i(`${t.link}/${a}`),t.title=="Geo Tagging"&&i(`${t.link}/${a}`),t.title=="Geo Map"&&i(`${t.link}/${a}`),t.title=="Reminder"&&g(!0),t.title=="Deny List"&&o(!0),t.title=="Adjust Demand"&&i(`${t.link}/${a}`),t.title=="Add Renter"&&i(`${t.link}/${a}`),t.title=="Deactivate Consumer"&&i(`${t.link}/${a}`),t.title=="Print Demand"&&i(`${t.link}/${a}`)},className:"w-14 h-14 flex items-center justify-center bg-[#12743B] rounded-2xl",children:e.jsx(q,{src:t.icon,alt:"icon",className:`${t.size}`})}),e.jsx("p",{className:"text-xs font-bold text-gray-800 mt-2 text-center",children:t.title})]},J+1))})]})]})}export{Ce as default};
