import{j as e,g as T,_ as y}from"./index-DEQSo8aR.js";import{r as F,R as $,b as K}from"./router-DQohkvhc.js";import{P as Q}from"./index-DbbiDRHT.js";import{I as U}from"./Image-CjBEPl8g.js";import{C as X}from"./card-DMq4rXlK.js";import{S as Y}from"./separator-_aC8Wpbw.js";import{b as W,u as Z}from"./useCustomQuery-B1dDSXi8.js";import{a as M,o as R,F as _,S as E,c as G,b as i}from"./SelectField-DmQJQBR3.js";import{u as H,a as L,b as B}from"./useComonData-0G3jZJua.js";import{R as x}from"./RHFTextField-BtHbYK6Z.js";import{B as w}from"./button-EPqXjhZy.js";import{R as I}from"./RotatingLoader-DHdHpJbP.js";import{C as J}from"./index-aDB13eqf.js";import{u as ee}from"./useMonthMap-C8hLMgQU.js";import{O as ae}from"./OverLayLoader-BHQq64dF.js";import"./headlessui-qWRqSxHB.js";import"./axios-DmypytPv.js";import"./module-Bh1YKffI.js";import"./moment-BjLXg0w5.js";const te=G().shape({aptName:i().required("Apartment Name is required"),wardNo:i().required("Ward No is required"),aptCode:i().required("Apartment Type is required"),aptAddress:i().required("Apartment Category is required"),pinCode:i().required("Apartment Status is required")});function se({id:l,open:m,setOpen:h,title:g,isEdit:f,mutate:c,refetch:p}){var j,b,N,v,r,S;const{getAllUser:u}=H(),C=()=>h(!m),a=W({api:`${(j=T)==null?void 0:j.getApartmentById}?id=${l}`,options:{enabled:!!l}}),s=M({resolver:R(te),defaultValues:{aptName:((N=(b=a==null?void 0:a.data)==null?void 0:b.data)==null?void 0:N.aptName)??"",wardNo:"",aptCode:"",aptAddress:"",pinCode:""}});F.useEffect(()=>{var d,n,k,t,q,o,V,z,P,D,O;(d=a==null?void 0:a.data)!=null&&d.data&&f&&(s.setValue("aptName",((k=(n=a==null?void 0:a.data)==null?void 0:n.data)==null?void 0:k.aptName)??""),s.setValue("wardNo",((q=(t=a==null?void 0:a.data)==null?void 0:t.data)==null?void 0:q.wardNo)??""),s.setValue("aptCode",((V=(o=a==null?void 0:a.data)==null?void 0:o.data)==null?void 0:V.aptCode)??""),s.setValue("aptAddress",((P=(z=a==null?void 0:a.data)==null?void 0:z.data)==null?void 0:P.aptAddress)??""),s.setValue("pinCode",((O=(D=a==null?void 0:a.data)==null?void 0:D.data)==null?void 0:O.pinCode)??""))},[a]);const A=async d=>{h(!1),J("Are you sure to pay?","Please confirm",async()=>{try{if(f){const n=await c.mutateAsync({api:T.updateApartment,data:{wardNo:d.wardNo,apartmentCode:d.aptCode,apartmentName:d.aptName,address:d.aptAddress,apartmentId:l,pinCode:d.pinCode}});n.data.status?(y.success(n.data.msg),p()):y.error(n.data.msg)}else{const n=await c.mutateAsync({api:T.addApartment,data:d});n.data.status?(y.success(n.data.msg),p()):y.error(n.data.msg)}}catch{y.error("Something went wrong")}})};return e.jsxs($.Fragment,{children:[m&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:`${m?"flex":"hidden"} overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full`,children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:g??"Add Floor"}),e.jsxs("button",{style:{background:"none"},onClick:C,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsx("div",{className:"p-4 md:p-5",children:a.isLoading?e.jsx("div",{className:"flex justify-center items-center h-[450px]",children:e.jsx(I,{})}):e.jsxs(_,{methods:s,onSubmit:s.handleSubmit(A),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{children:e.jsx(x,{name:"aptName",label:"Apartment Name",placeholder:"Enter Apartment Name",inputValidation:["removeDoubleSpace"]})}),e.jsx("div",{children:e.jsx(E,{name:"wardNo",label:"Ward No",data:((S=(r=(v=u==null?void 0:u.data)==null?void 0:v.data[0].ulbDetails[0])==null?void 0:r.wards)==null?void 0:S.map(d=>({label:String(d),value:String(d)})))??[]})}),e.jsx("div",{children:e.jsx(x,{name:"aptCode",label:"Apartment Code",placeholder:"Enter Apartment Code"})}),e.jsx("div",{children:e.jsx(x,{name:"aptAddress",label:"Apartment Address",placeholder:"Enter Apartment Address"})}),e.jsx("div",{children:e.jsx(x,{type:"number",name:"pinCode",label:"Pin Code",placeholder:"Enter Pin Code",inputValidation:["zip"]})})]}),e.jsxs("div",{className:"flex justify-end space-x-4 mt-6 mb-2",children:[e.jsx(w,{size:"sm",type:"button",onClick:C,className:"bg-gray-200 text-gray-900 w-20",children:"Cancel"}),e.jsx(w,{size:"sm",type:"submit",className:"w-20",children:f?"Update":"Save"})]})]})})]})})})]})}const re=G().shape({aptName:i().required("Apartment Name is required"),wardNo:i().required("Ward No is required"),aptCode:i().required("Apartment Type is required"),aptAddress:i().required("Apartment Category is required"),pinCode:i().required("Apartment Status is required"),noOfFlat:i().required("No of Flat is required"),consumerCategory:i().required("Consumer Category is required"),consumerType:i().required("Consumer Type is required"),demandFrom:i().required("Demand From is required")});function de({open:l,setOpen:m,title:h,mutate:g,refetch:f}){var j,b,N,v,r,S,d,n,k;const{getAllUser:c}=H(),{getConsumerAddFormData:p}=L(),{resultList:u}=ee("4-1-2022"),C=()=>m(!l),a=M({resolver:R(re),defaultValues:{aptName:"",wardNo:"",aptCode:"",aptAddress:"",pinCode:"",noOfFlat:"",consumerCategory:"",consumerType:"",demandFrom:""}}),s=async t=>{m(!1),J("Are you sure to pay?","Please confirm",async()=>{var q;try{const o=await(g==null?void 0:g.mutateAsync({api:(q=T)==null?void 0:q.createDefaultConsumerApartment,data:t}));o!=null&&o.data.status?(y.success(o==null?void 0:o.data.msg),f()):y.error(o==null?void 0:o.data.msg)}catch{y.error("Something went wrong")}})},{consumerCategoryData:A}=B(a.watch("consumerCategory"));return e.jsxs($.Fragment,{children:[l&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:`${l?"flex":"hidden"} overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full`,children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:h??"Add Floor"}),e.jsxs("button",{style:{background:"none"},onClick:C,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsx("div",{className:"p-4 md:p-5",children:e.jsxs(_,{methods:a,onSubmit:a.handleSubmit(s),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(x,{name:"aptName",label:"Apartment Name",placeholder:"Enter Apartment Name",inputValidation:["removeDoubleSpace"]})}),e.jsx("div",{children:e.jsx(x,{name:"aptCode",label:"Apartment Code",placeholder:"Enter Apartment Code"})}),e.jsx("div",{className:"col-span-2",children:e.jsx(E,{name:"wardNo",label:"Ward No",selectedText:"Select Ward No",data:((N=(b=(j=c==null?void 0:c.data)==null?void 0:j.data[0].ulbDetails[0])==null?void 0:b.wards)==null?void 0:N.map(t=>({label:String(t),value:String(t)})))??[]})}),e.jsx("div",{className:"col-span-2",children:e.jsx(x,{name:"aptAddress",label:"Apartment Address",placeholder:"Enter Apartment Address"})}),e.jsx("div",{children:e.jsx(x,{type:"number",name:"pinCode",label:"Pin Code",placeholder:"Enter Pin Code",inputValidation:["zip"]})}),e.jsx("div",{children:e.jsx(x,{type:"number",name:"noOfFlat",label:"No of Flat",placeholder:"Enter No of Flat"})}),e.jsx("div",{children:e.jsx(E,{name:"consumerCategory",label:"Consumer Category",selectedText:"Select Consumer Category",data:((S=(r=(v=p==null?void 0:p.data)==null?void 0:v.data)==null?void 0:r.consumerCategory)==null?void 0:S.map(t=>({label:String(t.name),value:String(t.id)})))??[]})}),e.jsx("div",{children:e.jsx(E,{name:"consumerType",label:"Consumer Type",selectedText:"Select Consumer Type",data:((k=(n=(d=A==null?void 0:A.data)==null?void 0:d.data)==null?void 0:n.consumerTypeList)==null?void 0:k.map(t=>({label:String(t.name),value:String(t.id)})))??[]})}),e.jsx("div",{className:"col-span-2",children:e.jsx(E,{name:"demandFrom",label:"Demand From",selectedText:"Select demand From",data:(u==null?void 0:u.map(t=>({label:String(t.str),value:String(t.str)})))??[]})})]}),e.jsxs("div",{className:"flex justify-end space-x-4 mt-6 mb-2",children:[e.jsx(w,{size:"sm",type:"button",onClick:C,className:"bg-gray-200 text-gray-900 w-20",children:"Cancel"}),e.jsx(w,{size:"sm",type:"submit",className:"w-20",children:"SAVE"})]})]})})]})})})]})}function we(){var j,b,N,v;const l=Z({}),[m,h]=F.useState(!1),[g,f]=F.useState(!1),[c,p]=F.useState(!1),u=K(),[C,a]=F.useState(""),s=W({api:(j=T)==null?void 0:j.getApartList,options:{enabled:!0}}),A=r=>{a(r),f(!0),h(!0)};return e.jsxs(Q,{title:"Apartment List",children:[m&&e.jsx(se,{id:C,isEdit:g,open:m,setOpen:h,title:g?"Edit Apartment":"Add Apartment",mutate:l,refetch:s.refetch}),c&&e.jsx(de,{open:c,setOpen:p,title:"Add Apartment with default",mutate:l,refetch:s.refetch}),l.isPending&&e.jsx(ae,{}),e.jsxs("main",{className:"py-6 grid grid-cols-1 gap-4 px-4",children:[e.jsxs("div",{className:"flex space-x-3 items-center justify-start",children:[e.jsx(U,{src:"/assets/image/category.png",alt:"Add Consumer",className:"w-12 h-12 rounded-lg bg-gray-200 p-2"}),e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Apartment List"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Add apartment details here."})]})]}),e.jsxs("div",{className:"flex space-x-3 items-center justify-end",children:[e.jsx(w,{size:"sm",onClick:()=>{a(""),f(!1),h(!0)},children:"Add Apartment."}),e.jsx(w,{size:"sm",onClick:()=>p(!0),children:"Add with default"})]}),e.jsx(Y,{}),(v=(N=(b=s==null?void 0:s.data)==null?void 0:b.data)==null?void 0:N.apartmentList)==null?void 0:v.map(r=>e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 px-4 py-6",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Apartment Name:"}),e.jsx("div",{className:"text-sm font-semibold",children:r.apt_name}),e.jsx("div",{className:"text-sm font-semibold",children:"Ward No:"}),e.jsx("div",{className:"text-sm font-semibold",children:r.ward_no}),e.jsx("div",{className:"text-sm font-semibold",children:"Apartment Code:"}),e.jsx("div",{className:"text-sm font-semibold",children:r.apt_code}),e.jsx("div",{className:"text-sm font-semibold",children:"Apartment Address:"}),e.jsx("div",{className:"text-sm font-semibold",children:r.apt_address}),e.jsxs("div",{className:"flex space-x-4 items-center justify-end  col-span-2",children:[e.jsx("button",{style:{background:"none"},className:"text-sm font-semibold text-primary bg-none",onClick:()=>A(r.id),children:"Edit"}),e.jsx("button",{style:{background:"none"},onClick:()=>u(`/deoghar-app/apartment-actions/${r.id}`),className:"text-sm font-semibold text-blue-500",children:"View"})]})]})},r.id))]})]})}export{we as default};
