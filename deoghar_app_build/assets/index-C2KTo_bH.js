import{g,j as a,h as z,_ as h}from"./index-CXOAeDMl.js";import{P as H}from"./index-es-K2YCM.js";import{C as J,b as U}from"./card-CBsAvuaM.js";import{c as k,b as s,a as K,F as Q,S as o,o as X}from"./SelectField-CQz-lEyZ.js";import{R as m}from"./RHFTextField-BnspFobf.js";import{B as Y}from"./button-BGfvnzrD.js";import{b as Z,r as D}from"./router-DQohkvhc.js";import{a as aa,u as ea,b as ra}from"./useComonData-48IxsRGt.js";import{I as ta}from"./Image-CLmzKIVg.js";import{S as sa}from"./separator-BEjnExSb.js";import{u as da}from"./useMonthMap-C8hLMgQU.js";import{u as na,b as R}from"./useCustomQuery-B99Ft0ae.js";import{O as oa}from"./OverLayLoader-DO2e3Bvm.js";import"./headlessui-qWRqSxHB.js";import"./axios-DmypytPv.js";import"./moment-BjLXg0w5.js";import"./module-Dle2zp6E.js";function Fa(){var b,j,y,N,f,C,w,S,v,F,A,q,L,I,P,T;const E=Z(),i=na({}),O=window.location.search,x=new URLSearchParams(O).get("id"),{resultList:W}=da("4-1-2022"),{getConsumerAddFormData:l}=aa(),{getAllUser:c}=ea(),_=k().shape({wardNo:s().required().label("Ward no"),apartmentId:s().required().label("Choose Apartment"),consumerName:s().required().label("Consumer name"),mobileNo:s().required().label("Mobile no"),consumerCategory:s().required().label("Consumer category"),consumerType:s().required().label("Consumer type"),demandFrom:s().required().label("Demand from"),firmName:s().when("consumerCategory",{is:"2",then:()=>s().required().label("Firm name")}),licenseNo:s().when("consumerCategory",{is:"2",then:()=>s().required().label("License no")}),address:s(),pinCode:s()}),d=K({resolver:X(_),defaultValues:{wardNo:"",apartmentId:"",address:"",pinCode:"",consumerName:"",mobileNo:"",consumerCategory:"",consumerType:"",demandFrom:"",firmName:"",licenseNo:""}}),r=R({api:`${g.getApartmentDetailsById}/${d.watch("apartmentId")}`,options:{enabled:!!d.watch("apartmentId")}});D.useEffect(()=>{var e,n,t,$,V,B,M;(e=r==null?void 0:r.data)!=null&&e.data[0]&&(d.setValue("wardNo",String((t=(n=r==null?void 0:r.data)==null?void 0:n.data[0])==null?void 0:t.wardNo)),d.setValue("address",String((V=($=r==null?void 0:r.data)==null?void 0:$.data[0])==null?void 0:V.address)),d.setValue("pinCode",String((M=(B=r==null?void 0:r.data)==null?void 0:B.data[0])==null?void 0:M.pinCode)))},[(j=(b=r==null?void 0:r.data)==null?void 0:b.data[0])==null?void 0:j.id]);const{consumerCategoryData:p}=ra(String(d.watch("consumerCategory"))),u=R({api:`${g.getApartmentListByWardNo}/${d.watch("wardNo")}`,options:{enabled:!!d.watch("wardNo")}}),G=async e=>{z("Are you sure?","Please confirm",async()=>{var n;try{const t=await(i==null?void 0:i.mutateAsync({api:(n=g)==null?void 0:n.postConsumerAdd,data:e}));t!=null&&t.data.status?(h.success(t==null?void 0:t.data.msg),E(`/deoghar-app/apartment-actions/${d.watch("apartmentId")}`)):h.error(t==null?void 0:t.data.msg)}catch{h.error("Something went wrong")}})};return a.jsxs(H,{title:"Add Flats",children:[JSON.stringify((N=(y=r==null?void 0:r.data)==null?void 0:y.data[0])==null?void 0:N.address),i.isPending&&a.jsx(oa,{}),a.jsxs("main",{className:"py-6 grid grid-cols-1 gap-4 px-4",children:[a.jsxs("div",{className:"flex space-x-3 items-center justify-start",children:[a.jsx(ta,{src:"/assets/image/category.png",alt:"Add Flats",className:"w-11 h-11 rounded-lg bg-gray-200 p-2"}),a.jsxs("div",{className:"",children:[a.jsx("h1",{className:"font-semibold",children:"Add flats"}),a.jsx("p",{className:"text-xs text-gray-500",children:"Solid waste management system"})]})]}),a.jsx(sa,{}),a.jsx(J,{children:a.jsx(U,{children:a.jsxs(Q,{methods:d,onSubmit:d.handleSubmit(G),children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsx("div",{children:a.jsx(o,{disabled:!!x,name:"wardNo",label:"Ward No",data:((w=(C=(f=c==null?void 0:c.data)==null?void 0:f.data[0].ulbDetails[0])==null?void 0:C.wards)==null?void 0:w.map(e=>({label:String(e),value:String(e)})))??[]})}),a.jsx("div",{children:a.jsx(o,{disabled:!!x,name:"apartmentId",label:"Choose Apartment",data:((F=(v=(S=u==null?void 0:u.data)==null?void 0:S.data)==null?void 0:v.apartmentList)==null?void 0:F.map(e=>({label:String(e.apt_name),value:String(e.id)})))??[]})}),a.jsx("div",{children:a.jsx(o,{name:"consumerCategory",label:"Consumer Category",data:((L=(q=(A=l==null?void 0:l.data)==null?void 0:A.data)==null?void 0:q.consumerCategory)==null?void 0:L.map(e=>({label:String(e.name),value:String(e.id)})))??[]})}),a.jsx("div",{children:a.jsx(o,{name:"consumerType",label:"Consumer Type",data:((T=(P=(I=p==null?void 0:p.data)==null?void 0:I.data)==null?void 0:P.consumerTypeList)==null?void 0:T.map(e=>({label:String(e.name),value:String(e.id)})))??[]})}),{2:a.jsxs(a.Fragment,{children:[a.jsx("div",{children:a.jsx(m,{name:"firmName",label:"Firm Name",type:"text"})}),a.jsx("div",{children:a.jsx(m,{name:"licenseNo",label:"License No",type:"text"})})]})}[d.watch("consumerCategory")],a.jsx("div",{children:a.jsx(m,{name:"consumerName",label:"Consumer Name",type:"text",inputValidation:["removeDoubleSpace"]})}),a.jsx("div",{children:a.jsx(m,{name:"mobileNo",label:"Mobile No",inputValidation:["mobile","number"]})}),a.jsx("div",{children:a.jsx(o,{name:"demandFrom",label:"Demand From",data:W.map(e=>({label:String(e.str),value:String(e.str)}))??[]})})]}),a.jsx("div",{className:"flex justify-center mt-6",children:a.jsx(Y,{type:"submit",variant:"default",size:"sm",className:"rounded-md w-24",children:"Add"})})]})})})]})]})}export{Fa as default};
