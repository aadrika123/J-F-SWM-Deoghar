import{d as x,j as e,B as k,C as J,_ as b}from"./index-j9I82nQr.js";import{P as K}from"./index-CforZJnI.js";import{C as Q,b as X}from"./card-DHBbtegN.js";import{c as Y,a as s,u as Z,F as D,S as o,o as ee}from"./SelectField-D_iHSFip.js";import{R as l}from"./RHFTextField-kqcFzDVf.js";import{d as ae,r as W}from"./router-CTqkcgir.js";import{a as re,u as te,b as se}from"./useComonData-h_M00ST6.js";import{I as de}from"./Image-C6UstR7o.js";import{S as ne}from"./separator-CzaTWi1P.js";import{u as ie}from"./useMonthMap-C8hLMgQU.js";import{u as oe,b as _}from"./useCustomQuery-n4GyWQha.js";import{O as me}from"./OverLayLoader-Dyo6puCE.js";import"./headlessui-BV7w-sRG.js";import"./axios-DmypytPv.js";import"./moment-BjLXg0w5.js";import"./module-CTPC1BkT.js";function Fe(){var y,N,j,f,C,v,w,S,q,F,A,R,L,$,T,I;const G=ae(),m=oe({}),O=window.location.search,n=new URLSearchParams(O).get("id"),{resultList:z}=ie("4-1-2022"),{getConsumerAddFormData:u}=re(),{getAllUser:c}=te(),H=Y().shape({wardNo:s().required().label("Ward no"),apartmentId:s().required().label("Choose Apartment"),consumerName:s().required().label("Consumer name"),mobileNo:s().required().label("Mobile no"),consumerCategory:s().required().label("Consumer category"),consumerType:s().required().label("Consumer type"),demandFrom:s().required().label("Demand from"),firmName:s().when("consumerCategory",{is:"2",then:()=>s().required().label("Firm name")}),licenseNo:s().when("consumerCategory",{is:"2",then:()=>s().required().label("License no")}),address:s(),pinCode:s()}),d=Z({resolver:ee(H),defaultValues:{wardNo:"",apartmentId:"",address:"",pinCode:"",consumerName:"",mobileNo:"",consumerCategory:"",consumerType:"",demandFrom:"",firmName:"",licenseNo:""}}),r=_({api:`${x.getApartmentDetailsById}/${n}`,options:{enabled:!!n}}),h=W.useMemo(()=>{var a,i,t,P,M,B,V,E;return{wardNo:`${(i=(a=r==null?void 0:r.data)==null?void 0:a.data[0])==null?void 0:i.wardNo}`??"",apartmentId:`${(P=(t=r==null?void 0:r.data)==null?void 0:t.data[0])==null?void 0:P.id}`??"",address:((B=(M=r==null?void 0:r.data)==null?void 0:M.data[0])==null?void 0:B.address)??"",pinCode:((E=(V=r==null?void 0:r.data)==null?void 0:V.data[0])==null?void 0:E.pinCode)??"",consumerName:"",mobileNo:"",consumerCategory:"",consumerType:"",demandFrom:"",firmName:"",licenseNo:""}},[(N=(y=r==null?void 0:r.data)==null?void 0:y.data[0])==null?void 0:N.id,(f=(j=r==null?void 0:r.data)==null?void 0:j.data[0])==null?void 0:f.wardNo]);W.useEffect(()=>{n&&d.reset(h)},[n,h]);const{consumerCategoryData:p}=se(String(d.watch("consumerCategory"))),g=_({api:`${x.getApartmentListByWardNo}/${d.watch("wardNo")}`,options:{enabled:!!d.watch("wardNo")}}),U=async a=>{J("Are you sure?","Please confirm",async()=>{var i;try{const t=await(m==null?void 0:m.mutateAsync({api:(i=x)==null?void 0:i.postConsumerAdd,data:a}));t!=null&&t.data.status?(b.success(t==null?void 0:t.data.msg),G(`/deoghar-app/apartment-actions/${d.watch("apartmentId")}`)):b.error(t==null?void 0:t.data.msg)}catch{b.error("Something went wrong")}})};return e.jsxs(K,{title:"Add Flats",children:[m.isPending&&e.jsx(me,{}),e.jsxs("main",{className:"py-6 grid grid-cols-1 gap-4 px-4",children:[e.jsxs("div",{className:"flex space-x-3 items-center justify-start",children:[e.jsx(de,{src:"/assets/image/category.png",alt:"Add Flats",className:"w-11 h-11 rounded-lg bg-gray-200 p-2"}),e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"font-semibold",children:"Add flats"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Solid waste management system"})]})]}),e.jsx(ne,{}),e.jsx(Q,{children:e.jsx(X,{children:e.jsxs(D,{methods:d,onSubmit:d.handleSubmit(U),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{children:e.jsx(o,{isRequired:!0,disabled:!!n,name:"wardNo",label:"Ward No",data:((w=(v=(C=c==null?void 0:c.data)==null?void 0:C.data[0].ulbDetails[0])==null?void 0:v.wards)==null?void 0:w.map(a=>({label:String(a),value:String(a)})))??[]})}),e.jsx("div",{children:e.jsx(o,{isRequired:!0,disabled:!!n,name:"apartmentId",label:"Choose Apartment",data:((F=(q=(S=g==null?void 0:g.data)==null?void 0:S.data)==null?void 0:q.apartmentList)==null?void 0:F.map(a=>({label:String(a.apt_name),value:String(a.id)})))??[]})}),e.jsx("div",{children:e.jsx(o,{isRequired:!0,name:"consumerCategory",label:"Consumer Category",data:((L=(R=(A=u==null?void 0:u.data)==null?void 0:A.data)==null?void 0:R.consumerCategory)==null?void 0:L.map(a=>({label:String(a.name),value:String(a.id)})))??[]})}),e.jsx("div",{children:e.jsx(o,{isRequired:!0,name:"consumerType",label:"Consumer Type",data:((I=(T=($=p==null?void 0:p.data)==null?void 0:$.data)==null?void 0:T.consumerTypeList)==null?void 0:I.map(a=>({label:String(a.name),value:String(a.id)})))??[]})}),{2:e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx(l,{isRequired:!0,name:"firmName",label:"Firm Name",type:"text"})}),e.jsx("div",{children:e.jsx(l,{name:"licenseNo",isRequired:!0,label:"License No",type:"text"})})]})}[d.watch("consumerCategory")],e.jsx("div",{children:e.jsx(l,{name:"consumerName",isRequired:!0,label:"Consumer Name",type:"text",inputValidation:["removeDoubleSpace"]})}),e.jsx("div",{children:e.jsx(l,{type:"number",isRequired:!0,name:"mobileNo",label:"Mobile No",inputValidation:["mobile","number"]})}),e.jsx("div",{children:e.jsx(o,{name:"demandFrom",isRequired:!0,label:"Demand From",data:z.map(a=>({label:String(a.str),value:String(a.str)}))??[]})})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(k,{type:"submit",variant:"default",size:"sm",className:"rounded-md w-24",children:"Add"})})]})})})]})]})}export{Fe as default};
