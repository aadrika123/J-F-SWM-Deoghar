import{j as e,B as P,d as E,C as $,_ as y}from"./index-CKexVv7f.js";import{r as q,R as W,d as K}from"./router-CTqkcgir.js";import{P as Q}from"./index-BHeHt4x3.js";import{I as U}from"./Image-CXKymwKi.js";import{C as X}from"./card-0XrvENI5.js";import{S as Y}from"./separator-BnIc1-si.js";import{b as M,u as Z}from"./useCustomQuery-Bm7Wew5S.js";import{u as R,o as _,F as G,S as F,c as L,a as l}from"./SelectField-CJOU9OFV.js";import{u as H,a as B,b as I}from"./useComonData-Mkhus79Y.js";import{R as h}from"./RHFTextField-D3c84PJ-.js";import{B as J}from"./ButtonLoading-DeNqAQPL.js";import{R as ee}from"./RotatingLoader-D1RfYI6f.js";import{u as ae}from"./useMonthMap-C8hLMgQU.js";import{O as se}from"./OverLayLoader-DVPDl0AJ.js";import"./headlessui-BV7w-sRG.js";import"./axios-DmypytPv.js";import"./module-B8PrYXwh.js";import"./moment-BjLXg0w5.js";const te=L().shape({aptName:l().required("Apartment Name is required"),wardNo:l().required("Ward No is required"),aptCode:l().required("Apartment Type is required"),aptAddress:l().required("Apartment Category is required"),pinCode:l().required("Apartment Status is required")});function re({id:m,open:p,setOpen:g,title:i,isEdit:f,mutate:t,refetch:x}){var j,b,N,v,d,w;const{getAllUser:u}=H(),C=()=>g(!p),a=M({api:`${(j=E)==null?void 0:j.getApartmentById}?id=${m}`,options:{enabled:!!m}}),r=R({resolver:_(te),defaultValues:{aptName:((N=(b=a==null?void 0:a.data)==null?void 0:b.data)==null?void 0:N.aptName)??"",wardNo:"",aptCode:"",aptAddress:"",pinCode:""}});q.useEffect(()=>{var n,o,S,s,k,c,T,V,z,D,O;(n=a==null?void 0:a.data)!=null&&n.data&&f&&(r.setValue("aptName",((S=(o=a==null?void 0:a.data)==null?void 0:o.data)==null?void 0:S.aptName)??""),r.setValue("wardNo",((k=(s=a==null?void 0:a.data)==null?void 0:s.data)==null?void 0:k.wardNo)??""),r.setValue("aptCode",((T=(c=a==null?void 0:a.data)==null?void 0:c.data)==null?void 0:T.aptCode)??""),r.setValue("aptAddress",((z=(V=a==null?void 0:a.data)==null?void 0:V.data)==null?void 0:z.aptAddress)??""),r.setValue("pinCode",((O=(D=a==null?void 0:a.data)==null?void 0:D.data)==null?void 0:O.pinCode)??""))},[a]);const A=async n=>{g(!1),$("Are you sure to pay?","Please confirm",async()=>{try{if(f){const o=await t.mutateAsync({api:E.updateApartment,data:{wardNo:n.wardNo,apartmentCode:n.aptCode,apartmentName:n.aptName,address:n.aptAddress,apartmentId:m,pinCode:n.pinCode}});o.data.status?(y.success(o.data.msg),x()):y.error(o.data.msg)}else{const o=await t.mutateAsync({api:E.addApartment,data:n});o.data.status?(y.success(o.data.msg),x()):y.error(o.data.msg)}}catch{y.error("Something went wrong")}})};return e.jsxs(W.Fragment,{children:[p&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:`${p?"flex":"hidden"} overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full`,children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:i??"Add Floor"}),e.jsxs("button",{style:{background:"none"},onClick:C,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsx("div",{className:"p-4 md:p-5",children:a.isLoading?e.jsx("div",{className:"flex justify-center items-center h-[450px]",children:e.jsx(ee,{})}):e.jsxs(G,{methods:r,onSubmit:r.handleSubmit(A),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{children:e.jsx(h,{name:"aptName",label:"Apartment Name",placeholder:"Enter Apartment Name",inputValidation:["removeDoubleSpace"]})}),e.jsx("div",{children:e.jsx(F,{name:"wardNo",label:"Ward No",data:((w=(d=(v=u==null?void 0:u.data)==null?void 0:v.data[0].ulbDetails[0])==null?void 0:d.wards)==null?void 0:w.map(n=>({label:String(n),value:String(n)})))??[]})}),e.jsx("div",{children:e.jsx(h,{name:"aptCode",label:"Apartment Code",placeholder:"Enter Apartment Code"})}),e.jsx("div",{children:e.jsx(h,{name:"aptAddress",label:"Apartment Address",placeholder:"Enter Apartment Address"})}),e.jsx("div",{children:e.jsx(h,{type:"number",name:"pinCode",label:"Pin Code",placeholder:"Enter Pin Code",inputValidation:["zip"]})})]}),e.jsxs("div",{className:"flex justify-end space-x-4 mt-6 mb-2",children:[e.jsx(P,{size:"sm",type:"button",onClick:C,className:"bg-gray-200 text-gray-900 w-20",children:"Cancel"}),e.jsx(J,{isLoading:t==null?void 0:t.isPending,disabled:t==null?void 0:t.isPending,size:"sm",type:"submit",className:"w-20",children:f?"Update":"Save"})]})]})})]})})})]})}const de=L().shape({aptName:l().required("Apartment Name is required"),wardNo:l().required("Ward No is required"),aptCode:l().required("Apartment Type is required"),aptAddress:l().required("Apartment Category is required"),pinCode:l().required("Apartment Status is required"),noOfFlat:l().required("No of Flat is required"),consumerCategory:l().required("Consumer Category is required"),consumerType:l().required("Consumer Type is required"),demandFrom:l().required("Demand From is required")});function ne({open:m,setOpen:p,title:g,mutate:i,refetch:f}){var j,b,N,v,d,w,n,o,S;const{getAllUser:t}=H(),{getConsumerAddFormData:x}=B(),{resultList:u}=ae("4-1-2022"),C=()=>p(!m),a=R({resolver:_(de),defaultValues:{aptName:"",wardNo:"",aptCode:"",aptAddress:"",pinCode:"",noOfFlat:"",consumerCategory:"",consumerType:"",demandFrom:""}}),r=async s=>{p(!1),$("Are you sure to pay?","Please confirm",async()=>{var k;try{const c=await(i==null?void 0:i.mutateAsync({api:(k=E)==null?void 0:k.createDefaultConsumerApartment,data:s}));c!=null&&c.data.status?(y.success(c==null?void 0:c.data.msg),f()):y.error(c==null?void 0:c.data.msg)}catch{y.error("Something went wrong")}})},{consumerCategoryData:A}=I(a.watch("consumerCategory"));return e.jsxs(W.Fragment,{children:[m&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:`${m?"flex":"hidden"} overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full`,children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:g??"Add Floor"}),e.jsxs("button",{style:{background:"none"},onClick:C,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsx("div",{className:"p-4 md:p-5",children:e.jsxs(G,{methods:a,onSubmit:a.handleSubmit(r),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(h,{name:"aptName",label:"Apartment Name",placeholder:"Enter Apartment Name",inputValidation:["removeDoubleSpace"]})}),e.jsx("div",{children:e.jsx(h,{name:"aptCode",label:"Apartment Code",placeholder:"Enter Apartment Code"})}),e.jsx("div",{className:"col-span-2",children:e.jsx(F,{name:"wardNo",label:"Ward No",selectedText:"Select Ward No",data:((N=(b=(j=t==null?void 0:t.data)==null?void 0:j.data[0].ulbDetails[0])==null?void 0:b.wards)==null?void 0:N.map(s=>({label:String(s),value:String(s)})))??[]})}),e.jsx("div",{className:"col-span-2",children:e.jsx(h,{name:"aptAddress",label:"Apartment Address",placeholder:"Enter Apartment Address"})}),e.jsx("div",{children:e.jsx(h,{type:"number",name:"pinCode",label:"Pin Code",placeholder:"Enter Pin Code",inputValidation:["zip"]})}),e.jsx("div",{children:e.jsx(h,{type:"number",name:"noOfFlat",label:"No of Flat",placeholder:"Enter No of Flat"})}),e.jsx("div",{children:e.jsx(F,{name:"consumerCategory",label:"Consumer Category",selectedText:"Select Consumer Category",data:((w=(d=(v=x==null?void 0:x.data)==null?void 0:v.data)==null?void 0:d.consumerCategory)==null?void 0:w.map(s=>({label:String(s.name),value:String(s.id)})))??[]})}),e.jsx("div",{children:e.jsx(F,{name:"consumerType",label:"Consumer Type",selectedText:"Select Consumer Type",data:((S=(o=(n=A==null?void 0:A.data)==null?void 0:n.data)==null?void 0:o.consumerTypeList)==null?void 0:S.map(s=>({label:String(s.name),value:String(s.id)})))??[]})}),e.jsx("div",{className:"col-span-2",children:e.jsx(F,{name:"demandFrom",label:"Demand From",selectedText:"Select demand From",data:(u==null?void 0:u.map(s=>({label:String(s.str),value:String(s.str)})))??[]})})]}),e.jsxs("div",{className:"flex justify-end space-x-4 mt-6 mb-2",children:[e.jsx(P,{size:"sm",type:"button",onClick:C,className:"bg-gray-200 text-gray-900 w-20",children:"Cancel"}),e.jsx(J,{isLoading:i==null?void 0:i.isPending,disabled:i==null?void 0:i.isPending,size:"sm",type:"submit",className:"w-20",children:"SAVE"})]})]})})]})})})]})}function we(){var j,b,N,v;const m=Z({}),[p,g]=q.useState(!1),[i,f]=q.useState(!1),[t,x]=q.useState(!1),u=K(),[C,a]=q.useState(""),r=M({api:(j=E)==null?void 0:j.getApartList,options:{enabled:!0}}),A=d=>{a(d),f(!0),g(!0)};return e.jsxs(Q,{title:"Apartment List",children:[p&&e.jsx(re,{id:C,isEdit:i,open:p,setOpen:g,title:i?"Edit Apartment":"Add Apartment",mutate:m,refetch:r.refetch}),t&&e.jsx(ne,{open:t,setOpen:x,title:"Add Apartment with default",mutate:m,refetch:r.refetch}),m.isPending&&e.jsx(se,{}),e.jsxs("main",{className:"py-6 grid grid-cols-1 gap-4 px-4",children:[e.jsxs("div",{className:"flex space-x-3 items-center justify-start",children:[e.jsx(U,{src:"/assets/image/category.png",alt:"Add Consumer",className:"w-12 h-12 rounded-lg bg-gray-200 p-2"}),e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Apartment List"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Add apartment details here."})]})]}),e.jsxs("div",{className:"flex space-x-3 items-center justify-end",children:[e.jsx(P,{size:"sm",onClick:()=>{a(""),f(!1),g(!0)},children:"Add Apartment."}),e.jsx(P,{size:"sm",onClick:()=>x(!0),children:"Add with default"})]}),e.jsx(Y,{}),(v=(N=(b=r==null?void 0:r.data)==null?void 0:b.data)==null?void 0:N.apartmentList)==null?void 0:v.map(d=>e.jsx(X,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 px-4 py-6",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Apartment Name:"}),e.jsx("div",{className:"text-sm font-semibold",children:d.apt_name}),e.jsx("div",{className:"text-sm font-semibold",children:"Ward No:"}),e.jsx("div",{className:"text-sm font-semibold",children:d.ward_no}),e.jsx("div",{className:"text-sm font-semibold",children:"Apartment Code:"}),e.jsx("div",{className:"text-sm font-semibold",children:d.apt_code}),e.jsx("div",{className:"text-sm font-semibold",children:"Apartment Address:"}),e.jsx("div",{className:"text-sm font-semibold",children:d.apt_address}),e.jsxs("div",{className:"flex space-x-4 items-center justify-end  col-span-2",children:[e.jsx("button",{style:{background:"none"},className:"text-sm font-semibold text-primary bg-none",onClick:()=>A(d.id),children:"Edit"}),e.jsx("button",{style:{background:"none"},onClick:()=>u(`/deoghar-app/apartment-actions/${d.id}`),className:"text-sm font-semibold text-blue-500",children:"View"})]})]})},d.id))]})]})}export{we as default};
