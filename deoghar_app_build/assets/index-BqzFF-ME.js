import{j as e,C as U,d as C,_ as b,u as de,B as Q}from"./index-DkGTr8py.js";import{R as X,r as w,h as te}from"./router-CxMlH8iW.js";import{P as ie}from"./index-BHsG9LAZ.js";import{I as le}from"./Image-CkmC2H9L.js";import{S as ne}from"./separator-CQwNH3jY.js";import{u as Y,b as Z}from"./useCustomQuery-IJyj9qiq.js";import{c as D,a as l,u as ee,F as ae,o as se,S as v}from"./SelectField-Ck3PxKFf.js";import{g as oe}from"./services-KQnp_8oA.js";import{R as ce}from"./RHFTextArea-DcyasjVa.js";import{B as re}from"./ButtonLoading-dCTh3U0u.js";import{C as me}from"./card-PeekMVMd.js";import{a as xe,u as he,b as pe}from"./useComonData--7Vu7jos.js";import{u as ue}from"./useMonthMap-DqC9yJdg.js";import{R as y}from"./RHFTextField-DDT445Gq.js";import{O as ge}from"./OverLayLoader-Dd3NujSM.js";import"./headlessui-BRR0nG4s.js";import"./axios-BR179gNb.js";import"./moment-CbGOrKEH.js";import"./module-D9RQCQ1g.js";function je({open:i,consumer:a,setOpen:g,title:c,refetch:r}){const o=Y({}),N=D().shape({remarks:l().required("Remarks is required")}),h=ee({resolver:se(N),defaultValues:{remarks:""}}),p=async d=>{U("Are you sure?","Please confirm",async()=>{var x,m,j;try{const t=await o.mutateAsync({api:C.postDeactivateConsumer,data:{...d,consumerId:a==null?void 0:a.consumerId}});(x=t==null?void 0:t.data)!=null&&x.status?(b.success((m=t==null?void 0:t.data)==null?void 0:m.msg),g(!1),r&&r()):b.error((j=t==null?void 0:t.data)==null?void 0:j.msg)}catch(t){b.error(oe(t))}})},u=()=>g(!i);return e.jsxs(X.Fragment,{children:[i&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"".concat(i?"flex":"hidden"," overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"),children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:c!=null?c:"Deactivate Consumer"}),e.jsxs("button",{style:{background:"none"},onClick:u,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsxs("div",{className:"p-4 md:p-5",children:[e.jsx(me,{className:"bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 p-4",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold",children:"Consumer no:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:a==null?void 0:a.consumerNo})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold",children:"Consumer name:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:a==null?void 0:a.consumerName})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold",children:"Ward:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:a==null?void 0:a.wardNo})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold",children:"Total demand:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:a==null?void 0:a.totaldemand})}),e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold",children:"Address:"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xs",children:a==null?void 0:a.address})})]})}),e.jsx("div",{className:"mt-8"}),e.jsxs(ae,{methods:h,onSubmit:h.handleSubmit(p),children:[e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsx("div",{children:e.jsx(ce,{name:"remarks",label:"Remarks",placeholder:"Remarks",isRequired:!0})})}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(re,{isLoading:o==null?void 0:o.isLoading,disabled:o==null?void 0:o.isLoading,type:"submit",variant:"destructive",size:"sm",className:"rounded-md w-24",children:"Deactivate"})})]})]})]})})})]})}function be({open:i,consumerDetails:a,setOpen:g,title:c,mutate:r,refetch:o}){var k,S,A,F,q,L,R,I,M,T,B,V,z,P,$,O,W;const{resultList:N}=ue("4-1-2022"),{getConsumerAddFormData:h}=xe(),{getAllUser:p}=he(),u=D().shape({wardNo:l().required().label("Ward no"),apartmentId:l().required().label("Choose Apartment"),consumerName:l().required().label("Consumer name"),mobileNo:l().required().label("Mobile no"),consumerCategory:l().required().label("Consumer category"),consumerType:l().required().label("Consumer type"),demandFrom:l().required().label("Demand from"),firmName:l().when("consumerCategory",{is:"2",then:()=>l().required().label("Firm name")}),licenseNo:l().when("consumerCategory",{is:"2",then:()=>l().required().label("License no")}),address:l().notRequired().label("Address"),pinCode:l().notRequired().label("Pin code")}),d=ee({defaultValues:{address:"",pinCode:"",wardNo:"",apartmentId:"",consumerName:"",mobileNo:"",consumerCategory:"",consumerType:"",demandFrom:"",firmName:"",licenseNo:""},resolver:se(u)}),{consumerCategoryData:x}=pe(String(d.watch("consumerCategory")));w.useEffect(()=>{var s,f,n,E,_,G,H,J,K;(s=a==null?void 0:a.data)!=null&&s.data&&(d.setValue("wardNo",String((n=(f=a==null?void 0:a.data)==null?void 0:f.data[0])==null?void 0:n.wardNo)),d.setValue("apartmentId",String((_=(E=a==null?void 0:a.data)==null?void 0:E.data[0])==null?void 0:_.id)),d.setValue("address",(H=(G=a==null?void 0:a.data)==null?void 0:G.data[0])==null?void 0:H.address),d.setValue("pinCode",(K=(J=a==null?void 0:a.data)==null?void 0:J.data[0])==null?void 0:K.pinCode))},[a]);const m=async s=>{U("Are you sure?","Please confirm",async()=>{var f;try{const n=await(r==null?void 0:r.mutateAsync({api:(f=C)==null?void 0:f.postConsumerAdd,data:s}));n!=null&&n.data.status?(b.success(n==null?void 0:n.data.msg),o()):b.error(n==null?void 0:n.data.msg)}catch(n){b.error("Something went wrong")}g(!1)})},j=()=>g(!i),t=Z({api:"".concat(C.getApartmentListByWardNo,"/").concat(d.watch("wardNo")),options:{enabled:!!d.watch("wardNo")}});return e.jsxs(X.Fragment,{children:[i&&e.jsx("div",{className:"bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40"}),e.jsx("div",{id:"authentication-modal",tabIndex:-1,"aria-hidden":"true",className:"".concat(i?"flex":"hidden"," overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"),children:e.jsx("div",{className:"relative p-4 w-full max-w-md max-h-full",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow dark:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:c!=null?c:"Add Flats"}),e.jsxs("button",{style:{background:"none"},onClick:j,type:"button",className:"end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white","data-modal-hide":"authentication-modal",children:[e.jsx("svg",{className:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})}),e.jsx("span",{className:"sr-only",children:"Close modal"})]})]}),e.jsx("div",{className:"p-4 md:p-5",children:e.jsxs(ae,{methods:d,onSubmit:d.handleSubmit(m),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx(v,{disabled:!0,name:"wardNo",label:"Ward No",data:(F=(A=(S=(k=p==null?void 0:p.data)==null?void 0:k.data[0].ulbDetails[0])==null?void 0:S.wards)==null?void 0:A.map(s=>({label:String(s),value:String(s)})))!=null?F:[]})}),e.jsx("div",{children:e.jsx(v,{disabled:!0,name:"apartmentId",label:"Choose Apartment",data:(I=(R=(L=(q=t==null?void 0:t.data)==null?void 0:q.data)==null?void 0:L.apartmentList)==null?void 0:R.map(s=>({label:String(s.apt_name),value:String(s.id)})))!=null?I:[]})}),e.jsx("div",{className:"col-span-2",children:e.jsx(y,{name:"address",label:"Address",disabled:!0,type:"text",inputValidation:["removeDoubleSpace"]})}),e.jsx("div",{className:"col-span-2",children:e.jsx(v,{name:"consumerCategory",label:"Consumer Category",isRequired:!0,data:(V=(B=(T=(M=h==null?void 0:h.data)==null?void 0:M.data)==null?void 0:T.consumerCategory)==null?void 0:B.map(s=>({label:String(s.name),value:String(s.id)})))!=null?V:[]})}),e.jsx("div",{className:"col-span-2",children:e.jsx(v,{name:"consumerType",label:"Consumer Type",isRequired:!0,data:(O=($=(P=(z=x==null?void 0:x.data)==null?void 0:z.data)==null?void 0:P.consumerTypeList)==null?void 0:$.map(s=>({label:String(s.name),value:String(s.id)})))!=null?O:[]})}),{2:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-span-2",children:e.jsx(y,{isRequired:!0,name:"firmName",label:"Firm Name",type:"text"})}),e.jsx("div",{className:"col-span-2",children:e.jsx(y,{isRequired:!0,name:"licenseNo",label:"License No",type:"text"})})]})}[d.watch("consumerCategory")],e.jsx("div",{className:"col-span-2",children:e.jsx(y,{name:"consumerName",isRequired:!0,label:"Consumer Name",type:"text",inputValidation:["removeDoubleSpace"]})}),e.jsx("div",{className:"col-span-2",children:e.jsx(y,{isRequired:!0,type:"number",name:"mobileNo",label:"Mobile No",inputValidation:["mobile","number"]})}),e.jsx("div",{className:"col-span-2",children:e.jsx(v,{isRequired:!0,name:"demandFrom",label:"Demand From",data:(W=N.map(s=>({label:String(s.str),value:String(s.str)})))!=null?W:[]})})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(re,{isLoading:r==null?void 0:r.isLoading,disabled:r==null?void 0:r.isLoading,type:"submit",variant:"default",size:"sm",className:"rounded-md w-24",children:"Add Flats"})})]})})]})})})]})}function Pe(){var d,x;const{user:i}=de(),a=Y({}),[g,c]=w.useState(!1),[r,o]=w.useState(!1),[N,h]=w.useState(null),{id:p}=te(),u=Z({api:"".concat(C.getApartmentDetailsById,"/").concat(p),options:{enabled:!!p}});return e.jsxs(ie,{title:"All flats",children:[e.jsx(be,{open:g,setOpen:c,consumerDetails:u,mutate:a,refetch:u.refetch}),r&&e.jsx(je,{open:r,setOpen:o,consumer:N,refetch:u.refetch}),a.isLoading&&e.jsx(ge,{}),e.jsxs("main",{className:"py-6 grid grid-cols-1 gap-4 px-4",children:[e.jsxs("div",{className:"flex space-x-3 items-center justify-start",children:[e.jsx(le,{src:"/assets/image/category.png",alt:"All flats",className:"w-11 h-11 rounded-lg bg-gray-200 p-2"}),e.jsxs("div",{className:"",children:[e.jsx("h1",{className:"font-semibold",children:"All flats"}),e.jsx("p",{className:"text-xs text-gray-500",children:"All flats details here."})]})]}),(i==null?void 0:i.userTypeId)==4&&e.jsx("div",{className:"flex space-x-3 items-center justify-end",children:e.jsx(Q,{size:"sm",onClick:()=>{c(!0)},children:"Add Flats"})}),e.jsx(ne,{}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:(x=(d=u.data)==null?void 0:d.data)==null?void 0:x.map((m,j)=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 flex gap-4  justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Consumer name"}),e.jsx("h2",{className:"font-semibold text-sm",children:m.consumerName})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Consumer no"}),e.jsx("h2",{className:"font-semibold text-sm",children:m.consumerNo})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Mobile no"}),e.jsx("h2",{className:"font-semibold text-sm",children:m.mobileNo})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Monthly rate"}),e.jsx("h2",{className:"font-semibold text-sm",children:m.monthlyDemand})]})]}),(i==null?void 0:i.userTypeId)==4&&e.jsx("div",{className:"mb-0",children:e.jsx(Q,{size:"sm",onClick:()=>{h(m),o(!0)},className:"bg-red-700 text-white",children:"Deactivate"})})]},j+1))})]})]})}export{Pe as default};
