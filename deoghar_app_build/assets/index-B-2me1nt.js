import{j as e,i as J,u as K,g as h,h as Q,_ as c}from"./index-BcSDAYQy.js";import{P as X}from"./index-J44beZ8l.js";import{d as Y,r as E,h as Z}from"./router-CTqkcgir.js";import{a as C,o as D,F as ee,c as se,d as te,b as g}from"./SelectField-K2-9aOpB.js";import{R as u}from"./RHFTextField-BRu0HiXJ.js";import{R as re}from"./RHFTextArea-BXhFU1tH.js";import{B as ae}from"./button-CsnK0fxW.js";import{u as de,a as oe}from"./useCustomQuery-Dq0ecwmr.js";import{r as ne}from"./resizeImage-SPk1zJz-.js";import{S as H}from"./separator-CnGhRSp5.js";import{I as q}from"./Image-Bg3N0v8H.js";import{O as le}from"./OverLayLoader-EySDu2W8.js";import"./headlessui-BV7w-sRG.js";import"./axios-DmypytPv.js";import"./module-CmHYFK_O.js";const ie=({status:t})=>e.jsx("div",{className:"p-5",children:e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:`flex items-center ${t==3||t==2||t==1?"text-white":"text-gray-400"}`,children:[e.jsx("div",{className:`rounded-full transition duration-500 ease-in-out h-12 w-12 py-3 border-2 ${t==3||t==2||t==1?"bg-teal-600 border-teal-600":"border-gray-300"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-bookmark",children:e.jsx("path",{d:"M12 2v10m0 0v10m-7-10h14m-14 4h14m-14 4h14m-14 4h14M5 5v14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2z"})})}),e.jsx("div",{className:`absolute top-4 -ml-10 text-center mt-36 w-32 text-xs font-medium  ${t==3||t==2||t==1?"text-teal-600":"text-gray-400"}`,children:"Tax Collector"})]}),e.jsx("div",{className:`flex-auto border-t-2 transition duration-500 ease-in-out ${t==3||t==2||t==1?"border-teal-600":"border-gray-300"}`}),e.jsxs("div",{className:`flex items-center ${t==3||t==2||t==1?"text-white":"text-gray-400"}`,children:[e.jsx("div",{className:`rounded-full transition duration-500 ease-in-out h-12 w-12 py-3 border-2 ${t==3||t==2||t==1?"bg-teal-600 border-teal-600":"border-gray-300"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-user-check",children:e.jsx("path",{d:"M17 20h4v-4m-14 4h4v-4m0-6l7-5-7-5v10m-7-5h10"})})}),e.jsx("div",{className:`absolute top-4 -ml-10 text-center mt-36 w-32 text-xs font-medium  ${t==3||t==2||t==1?"text-teal-600":"text-gray-400"}`,children:"Team Lead"})]}),e.jsx("div",{className:`flex-auto border-t-2 transition duration-500 ease-in-out ${t==3||t==2||t==1?"border-teal-600":"border-gray-300"}`}),e.jsxs("div",{className:`flex items-center ${t==2||t==1?"text-white":"text-gray-400"}`,children:[e.jsx("div",{className:`rounded-full transition duration-500 ease-in-out h-12 w-12 py-3 border-2 ${t==2||t==1?"bg-teal-600 border-teal-600":"border-gray-300"}`,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-loader",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"6",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"18"}),e.jsx("line",{x1:"6",y1:"12",x2:"6",y2:"12"}),e.jsx("line",{x1:"18",y1:"12",x2:"18",y2:"12"})]})}),e.jsx("div",{className:`absolute top-4 -ml-10 text-center mt-36 w-32 text-xs font-medium  ${t==2||t==1?"text-teal-600":"text-gray-400"}`,children:"In progress"})]}),e.jsx("div",{className:`flex-auto border-t-2 transition duration-500 ease-in-out ${t==1?"border-teal-600":"border-gray-300"}`}),e.jsxs("div",{className:`flex items-center ${t==1?"text-white":"text-gray-400"}`,children:[e.jsx("div",{className:`rounded-full transition duration-500 ease-in-out h-12 w-12 py-3 border-2 ${t===1?"bg-teal-600 border-teal-600":"border-gray-300"}`,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-check-circle",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]})}),e.jsx("div",{className:`absolute top-4 -ml-10 text-center mt-36 w-32 text-xs font-medium  ${t==1?"text-teal-600":"text-gray-400"}`,children:"Resolved"})]})]})})}),ce=ie,me=se().shape({photo:te().required("Photo is required").nullable(),latitude:g(),longitude:g(),remarks:g()});function Se(){var p,b,y,N,v,w,k,$,L,S,R,F,_,P,I,A,V,B,T,M,O,U,W;const t=Y(),[j,f]=E.useState(""),m=de({}),{coords:n}=J(),{user:x}=K(),{id:i}=Z(),s=oe({api:h.getComplainDetails,config:{id:i},options:{enabled:!!i}}),l=C({resolver:D(me),defaultValues:{photo:null,latitude:"",longitude:"",remarks:""}});E.useEffect(()=>{var a,r,o,d;(r=(a=s==null?void 0:s.data)==null?void 0:a.data)!=null&&r.tc_photo&&f((d=(o=s==null?void 0:s.data)==null?void 0:o.data)==null?void 0:d.tc_photo)},[(b=(p=s==null?void 0:s.data)==null?void 0:p.data)==null?void 0:b.tc_photo]);const z=async a=>{Q("Are you sure?","Please confirm",async()=>{try{const r=new FormData;r.append("photo",a.photo),r.append("latitude",String(a.latitude)),r.append("longitude",String(a.longitude)),r.append("id",String(i)),r.append("remarks",String(a.remarks));const o=await m.mutateAsync({api:h.switchStatus,data:{id:i}});if(o.data.status){const d=await m.mutateAsync({api:h.complainResolved,data:r});d.data.status?(c.success(d.data.msg),t("/deoghar-app/view-complain-list")):c.error(d.data.msg)}else c.error(o.data.msg)}catch(r){c.error(r.msg)}})},G=async a=>{const r=a.target.files[0];if(!r)return;const o=await ne(r),d=new File([o],r==null?void 0:r.name,{type:"image/*"});l.setValue("photo",d),l.setValue("latitude",String(n==null?void 0:n.latitude)),l.setValue("longitude",String(n==null?void 0:n.longitude)),f(URL.createObjectURL(d)||URL.createObjectURL(r))};return e.jsxs(X,{title:"Complain Details",children:[m.isPending&&e.jsx(le,{}),e.jsx("main",{className:"p-4",children:s!=null&&s.isFetching?e.jsx("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm",children:e.jsx("div",{className:"animate-pulse flex space-x-4",children:e.jsxs("div",{className:"flex-1 space-y-4 py-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-5/6"})]})]})})}):e.jsx("div",{children:s.status==="success"?e.jsxs(e.Fragment,{children:[e.jsx(ce,{status:(N=(y=s==null?void 0:s.data)==null?void 0:y.data)==null?void 0:N.status}),e.jsx("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm mt-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 justify-center items-center",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-500",children:"Consumer Name:"}),e.jsx("div",{className:"text-sm font-semibold text-gray-500 w-30 truncate",children:(w=(v=s==null?void 0:s.data)==null?void 0:v.data)==null?void 0:w.consumer_name}),e.jsx("div",{className:"text-sm font-semibold text-gray-500",children:"Complain No:"}),e.jsx("div",{className:"text-sm font-semibold text-gray-500",children:($=(k=s==null?void 0:s.data)==null?void 0:k.data)==null?void 0:$.complain_no}),e.jsx("div",{className:"text-sm font-semibold text-gray-500",children:"Consumer No:"}),e.jsx("div",{className:"text-sm font-semibold text-gray-500",children:(S=(L=s==null?void 0:s.data)==null?void 0:L.data)==null?void 0:S.consumer_no}),e.jsx("div",{className:"text-sm font-semibold text-gray-500",children:"Address:"}),e.jsx("div",{className:"text-sm font-semibold text-gray-500",children:(F=(R=s==null?void 0:s.data)==null?void 0:R.data)==null?void 0:F.address}),e.jsx("div",{className:"text-sm font-semibold text-gray-500",children:"Complain:"}),e.jsx("div",{className:"text-sm font-semibold text-gray-500",children:(P=(_=s==null?void 0:s.data)==null?void 0:_.data)==null?void 0:P.complain}),e.jsx("div",{className:"text-sm font-semibold text-gray-500",children:"TC Remarks:"}),e.jsx("div",{className:"text-sm font-semibold text-gray-500",children:(A=(I=s==null?void 0:s.data)==null?void 0:I.data)==null?void 0:A.tc_remarks})]})}),e.jsx(H,{className:"mt-4 mb-4"}),e.jsxs("div",{className:"flex justify-center items-center space-x-4",children:[((B=(V=s==null?void 0:s.data)==null?void 0:V.data)==null?void 0:B.tl_photo)!=""&&e.jsxs("div",{className:"flex-col",children:[e.jsx(q,{src:(M=(T=s==null?void 0:s.data)==null?void 0:T.data)==null?void 0:M.tl_photo,className:"rounded-lg shadow-lg h-40 w-40 "}),e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Complain Resolved Image"})]}),e.jsx("div",{className:"flex justify-center col-span-2",children:j!=""&&e.jsxs("div",{className:"flex-col",children:[e.jsx(q,{src:j,className:"rounded-lg shadow-lg h-40 w-40 "}),e.jsx("span",{className:"text-sm font-semibold text-gray-500",children:"Complain Raised Image"})]})})]}),e.jsx(H,{className:"mt-4 mb-4"}),(x==null?void 0:x.userTypeId)==4&&((U=(O=s==null?void 0:s.data)==null?void 0:O.data)==null?void 0:U.status)!=1&&e.jsxs(ee,{methods:l,onSubmit:l.handleSubmit(z),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(u,{type:"file",onChange:a=>{G(a)},label:"Upload Photo"})}),e.jsx("div",{children:e.jsx(u,{name:"latitude",label:"Latitude",className:"w-full",disabled:!0})}),e.jsx("div",{children:e.jsx(u,{name:"longitude",label:"Longitude",className:"w-full",disabled:!0})}),e.jsx("div",{className:"col-span-2",children:e.jsx(re,{name:"remarks",label:"Remarks",className:"border border-gray-200 rounded-lg p-2 w-full"})})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(ae,{type:"submit",variant:"default",children:"Submit"})})]})]}):e.jsx("div",{className:"p-6 bg-white border border-gray-200 rounded-lg shadow-sm mt-4",children:e.jsx("div",{className:"text-center text-red-500",children:(W=s.data)==null?void 0:W.msg})})})})]})}export{Se as default};
